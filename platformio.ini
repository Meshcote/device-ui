[env:heltec-lora-wifi-v3-ili9225]
platform = espressif32
board = heltec_wifi_lora_32_V3
framework = arduino

; ESP32-S3 sin PSRAM
board_build.arduino.memory_type = qio_qspi
board_build.flash_mode = qio
board_build.partitions = default_8MB.csv

; Incluir el driver ILI9225, la UI generada y el sistema de localización
build_src_filter = 
    +<*> 
    +<../source/graphics/ILI9225Display.cpp>
    +<../source/input/InputDriver.cpp>
    +<../source/input/I2CKeyboardScanner.cpp>
    +<../source/input/I2CKeyboardInputDriver.cpp>
    +<../generated/ui_320x240/*.c>
    +<../locale/lv_i18n.c>

build_flags = 
    ; Sin PSRAM - optimización crítica
    -DBOARD_HAS_PSRAM=0
    -DCONFIG_SPIRAM_SUPPORT=0
    -DCONFIG_ESP32S3_SPIRAM_SUPPORT=0
    -DILI9225_DISPLAY=1
    -DCORE_DEBUG_LEVEL=3
    
    ; Optimizaciones de memoria
    -Os
    -DLVGL_MEM_SIZE=49152
    -DLV_CONF_INCLUDE_SIMPLE
    -DLV_LVGL_H_INCLUDE_SIMPLE
    
    ; Fuentes LVGL necesarias para la UI
    -DLV_FONT_MONTSERRAT_10=1
    -DLV_FONT_MONTSERRAT_12=1
    -DLV_FONT_MONTSERRAT_14=1
    -DLV_FONT_MONTSERRAT_16=1
    -DLV_FONT_MONTSERRAT_20=1
    
    ; Rutas de include para UI y localización
    -I locale
    -I generated/ui_320x240
    
    ; Pines ILI9225 según hardware del usuario
    -DTFT_CS=7
    -DTFT_DC=5
    -DTFT_RST=6
    -DTFT_MOSI=4
    -DTFT_SCLK=3
    -DTFT_BL=2
    
    ; Tamaño de pantalla ILI9225
    -DSCREEN_WIDTH=176
    -DSCREEN_HEIGHT=220

lib_deps = 
    lvgl/lvgl @ ^9.0.0

monitor_speed = 115200
upload_speed = 921600
monitor_filters = esp32_exception_decoder
